FROM innovateuk/app-base-image
EXPOSE 8080
EXPOSE 8090
EXPOSE 8081
EXPOSE 8000
EXPOSE 12345
ENV JAVA_OPTS -Xmx300m
ENV JMX_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8001 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false

WORKDIR /
VOLUME /tmp

ENV IFS_STORAGE=/mnt/ifs_storage

RUN mkdir -p ${IFS_STORAGE}
RUN chmod -R u+x ${IFS_STORAGE} && \
    chgrp -R 0 ${IFS_STORAGE}

ADD newrelic.jar /
ADD newrelic.yml /
ADD coscale-monitoring.sh /root/coscale-monitoring.sh
ADD @app_name@-@version@-autostart.jar app.jar

ENTRYPOINT exec java -Dfile.encoding=UTF8 $JAVA_OPTS $JMX_OPTS -jar app.jar
