apply from: "database-support.gradle"

subprojects {


    apply from: rootProject.file("java-spring-boot.gradle")
    ext.ifsWebSystemUserId="8394d970-b250-4b15-9621-3534325691b4"

    // data-service-commons is not a docker project.
    if (it.name != 'data-service-commons') {

        apply from: rootProject.file("openshift-build.gradle")
        apply from: rootProject.file("prepare-docker.gradle")

        ext.dockerDir = "$project.parent.projectDir/docker/"

        buildDocker.dependsOn prepareDockerInput
        buildDocker.dependsOn ":docker:app-base-image:buildDocker"
        buildDocker.tag="innovateuk/" + project.name.replaceAll(/ifs-/,"")+":latest"
        buildDocker.inputDir = project.file("$project.buildDir/docker")
        tagDocker.imageId="innovateuk/" + project.name.replaceAll(/ifs-/,"")+":latest"

    }

}

buildscript {

    repositories {
        mavenCentral()
        jcenter()
    }

    dependencies {
        classpath 'org.flywaydb:flyway-gradle-plugin:4.0'
        classpath 'org.flywaydb:flyway-core:4.0'
    }
}

task initDB {
    createTestSchema.mustRunAfter startMySql

    dependsOn startMySql
    dependsOn createTestSchema
}

ext {
    snippetsDir = file('build/generated-snippets')
    javaLanguageLevel = 1.8
    generatedMapperSourcesDir = 'build/classes/main/org/innovateuk/ifs/mappers'
}