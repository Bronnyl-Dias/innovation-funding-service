<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:ifs="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Feedback overview'" />
</head>

<body class="app-summary" th:classappend="${interviewFeedbackViewModel.currentApplication.isOpen() ? 'is-open' : 'is-closed' }">
<th:block th:insert="fragments/layout :: body-start" />
<th:block th:insert="fragments/layout :: global-header" />

<main tabindex="-1" id="content">
    <th:block th:insert="fragments/layout :: header-sub" th:with="linkTitle='Dashboard',linkClass='link-back',linkUrl=@{/applicant/dashboard}"/>
    <th:block th:insert="fragments/elements :: competition-closing-warning (competition=${interviewFeedbackViewModel.currentCompetition})" />
    <th:block th:with="applicationName=${#strings.isEmpty(interviewFeedbackViewModel.currentApplication.name)} ? #{ifs.application.no_title} : ${interviewFeedbackViewModel.currentApplication.name}">
        <th:block th:insert="fragments/layout :: page-title" th:with="pageTitle='Feedback overview',subTitle=${interviewFeedbackViewModel.currentApplication.name},size='heading-xlarge'" />
    </th:block>

    <!--<div th:if="${#fields.hasErrors('${interviewResponseForm.*}')}" class="error-summary" role="alert" aria-labelledby="error-summary-heading" tabindex="-1">-->
        <!--<h2 class="heading-medium error-summary-heading" id="error-summary-heading">We were unable to upload your file.</h2>-->
        <!--<th:block th:insert="fragments/elements :: error-summary-list(interviewResponseForm)" />-->
    <!--</div>-->

    <div class="grid-row">
        <div class="column-half">
            <h3 class="heading-small">Project title</h3>
            <p th:text="${interviewFeedbackViewModel.currentApplication.name}">Machine learning in robots</p>

            <h3 class="heading-small">Application number</h3>
            <p th:text="${interviewFeedbackViewModel.currentApplication.id}">Machine learning in robots</p>

            <h3 class="heading-small">Lead organisation</h3>
            <p th:text="${interviewFeedbackViewModel.leadOrganisation.name}">Aptrans Ltd</p>

            <h3 class="heading-small">Partners</h3>
            <ul class="list">
                <li th:each="organisation : ${interviewFeedbackViewModel.applicationOrganisations}" th:unless="${organisation.equals(interviewFeedbackViewModel.leadOrganisation)}" th:text="${organisation.name}">Biotech Corp</li>
            </ul>
        </div>

        <div class="column-half">
            <h3 class="heading-small">Project timescales</h3>
            <p>Project start date: <br />
                <th:block
                    th:if="${interviewFeedbackViewModel.currentApplication.startDate}"
                    th:text="${#temporals.format(interviewFeedbackViewModel.currentApplication.startDate, 'd MMMM yyyy')}" />
            </p>
            <p>Duration: <br /><th:block th:text="${interviewFeedbackViewModel.currentApplication.durationInMonths}" /> months</p>

            <h3 class="heading-small extra-margin">Total project cost</h3>
            <p>&pound;<th:block th:text="${interviewFeedbackViewModel.totalFundingSought} ? ${#numbers.formatInteger(interviewFeedbackViewModel.totalFundingSought, 0, 'DEFAULT')} : '0'">203,567</th:block></p>
        </div>
    </div>

    <!--<div th:unless="${interviewFeedbackViewModel.feedbackReleased}" class="message-alert">-->
        <!--<p th:text="${interviewFeedbackViewModel.bannerText}">Some info</p>-->
    <!--</div>-->

    <!--<th:block th:if="${interviewFeedbackViewModel.responseSectionEnabled}">-->
        <!--<th:block th:if="${interviewFeedbackViewModel.leadApplicant}">-->
            <!--<form th:action="@{/application/{applicationId}/summary(applicationId=${currentApplication.id})}"-->
                  <!--method="post" enctype="multipart/form-data" th:object="${interviewResponseForm}" novalidate="novalidate">-->
                <!--<h2 class="heading-medium">Your response</h2>-->
                <!--<div class="upload-section">-->
                    <!--<details th:unless="${interviewFeedbackViewModel.feedbackReleased}" role="group">-->
                        <!--<summary role="button" aria-controls="details-content-0" aria-expanded="false">-->
                            <!--<span class="summary">What should I include in the response?</span>-->
                        <!--</summary>-->
                        <!--<div class="panel" id="details-content-0" aria-hidden="true">-->
                            <!--<p>You may submit a written response to this feedback. You can upload up to 3 A4 pages in a single PDF-->
                                <!--document, including charts and diagrams. The maximum file upload size is 2MB.</p>-->
                        <!--</div>-->
                    <!--</details>-->
                    <!--<div th:unless="${interviewFeedbackViewModel.hasResponse()}">-->
                        <!--<p class="uploaded-file">No file currently uploaded</p>-->
                        <!--<input type="file" id="feedback-response" name="response" class="inputfile">-->
                        <!--<label for="feedback-response" class="button-secondary extra-margin">+ Upload</label>-->
                        <!--<button name="uploadResponse" class="button-secondary" data-for-file-upload="feedback-response"></button>-->
                    <!--</div>-->
                    <!--<div th:if="${interviewFeedbackViewModel.hasResponse()}">-->
                        <!--<p class="uploaded-file"><a th:href="@{/application/{applicationId}/summary/download-response(applicationId=${currentApplication.id})}"-->
                                                    <!--th:text="${interviewFeedbackViewModel.responseFilename + ' (opens in a new window)'}"-->
                                                    <!--target="_blank">File</a></p>-->
                        <!--<button th:unless="${interviewFeedbackViewModel.feedbackReleased}" name="removeResponse" class="button-secondary">Remove</button>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</form>-->
        <!--</th:block>-->
        <!--<th:block th:unless="${interviewFeedbackViewModel.leadApplicant}">-->
            <!--<h2 class="heading-medium">Response from lead applicant</h2>-->
            <!--<th:block th:unless="${interviewFeedbackViewModel.hasResponse()}">-->
                <!--<p>The lead applicant has not yet uploaded a response.</p>-->
            <!--</th:block>-->
            <!--<th:block th:if="${interviewFeedbackViewModel.hasResponse()}">-->
                <!--<div class="form-group download">-->
                    <!--<h3 class="heading-small no-margin">Lead applicant response</h3>-->
                    <!--<p class="uploaded-file"><a th:href="@{/application/{applicationId}/summary/download-response(applicationId=${currentApplication.id})}"-->
                       <!--th:text="${interviewFeedbackViewModel.responseFilename + ' (opens in a new window)'}"-->
                       <!--target="_blank">File</a></p>-->
                <!--</div>-->
            <!--</th:block>-->
        <!--</th:block>-->
    <!--</th:block>-->

    <h2 class="heading-medium no-margin-bottom">Assessor feedback</h2>
    <p class="form-hint">Assessors do not provide scores on these sections of the application.</p>

    <section th:each="section : ${interviewFeedbackViewModel.sections.values()}" th:unless="${section.name.equals('Finances')}">
        <th:block th:if="${section.name.equals('Project details')}">
            <ul class="list-overview">
                <th:block th:each="question : ${interviewFeedbackViewModel.sectionQuestions.get(section.id)}" th:unless="${question.questionSetupType == T(org.innovateuk.ifs.competition.resource.CompetitionSetupQuestionType).APPLICATION_DETAILS}">
                    <li class="section-status grid-row">
                        <div class="column-two-thirds">
                            <h3 class="heading-small">
                                <a th:href="@{/application/{apId}/question/{qId}/feedback(apId=${interviewFeedbackViewModel.currentApplication.id},qId=${question.id})}"
                                   th:text="${question.shortName}" >Project summary</a>
                            </h3>
                        </div>
                        <div class="column-third">
                                <p class="form-hint no-margin">No feedback provided</p>
                        </div>
                    </li>
                </th:block>
            </ul>
        </th:block>
        <th:block th:if="${!section.name.equals('Project details')}">
            <h2 class="heading-medium no-margin-bottom">Assessor feedback</h2>
            <p class="form-hint">Each question has been assessed by several independent assessors. They have given a score and feedback for each.</p>

            <ul class="list-overview">
                <li class="section-status grid-row" th:each="question : ${interviewFeedbackViewModel.sectionQuestions.get(section.id)}">
                    <div class="column-two-thirds">
                        <h3 class="heading-small">
                            <a th:href="@{/application/{apId}/question/{qId}/feedback(apId=${interviewFeedbackViewModel.currentApplication.id},qId=${question.id})}"
                               th:text="${question.questionNumber!=null ? question.questionNumber + '. ' : '' } + ${question.shortName}">1. Business opportunity</a>
                        </h3>
                    </div>
                    <div>
                        <div class="column-third" th:text="|Average score ${interviewFeedbackViewModel.scores.scores.get(question.id)} / ${question.assessorMaximumScore}|">Average score 7 / 10</div>
                    </div>
                </li>
            </ul>
            <div class="grid-row extra-margin">
                <div class="column-two-thirds">
                    &nbsp;
                </div>
                <div class="column-third">
                    <p>Average overall: <strong class="heading-" th:text="|${interviewFeedbackViewModel.scores.averagePercentage}%|">70%</strong></p>
                </div>
            </div>
        </th:block>
    </section>

    <!--<th:block th:if="${interviewFeedbackViewModel.hasFeedback()}">-->
        <!--<h2 class="heading-medium">Additional feedback</h2>-->
        <!--<div class="form-group download">-->
            <!--<h3 class="heading-small no-margin">Panel assessment feedback</h3>-->
            <!--<a target="_blank" href=""-->
               <!--th:href="@{/application/{applicationId}/summary/download-feedback(applicationId=${currentApplication.id})}"-->
               <!--th:text="${interviewFeedbackViewModel.feedbackFilename + ' (opens in a new window)'}">panel-assessment-feedback.pdf, 6 KB (opens in a new window)</a>-->
        <!--</div>-->
    <!--</th:block>-->

    <section th:if="${interviewFeedbackViewModel.hasFinanceSection}">
        <h2 class="heading-medium">Finance</h2>
        <div class="collapsible">
            <h3>Finances summary</h3>
            <div class="question">
                <div ifs:global="${interviewFeedbackViewModel.applicationFinanceSummaryViewModel}" th:replace="finance/finance-summary :: application_finances_summary (isApplicant = true)"></div>
                <h2 class="heading-medium">Funding breakdown</h2>
                <th:block ifs:global="${interviewFeedbackViewModel.applicationFundingBreakdownViewModel}" th:insert="finance/finance-summary :: financial_summary_table" />
            </div>
        </div>
    </section>

    <div th:if="!${#lists.isEmpty(interviewFeedbackViewModel.feedback)}">
        <h2 class="heading-medium">Assessor feedback</h2>
        <ul class="boxed-list">
            <li th:each="item, iterStat : ${interviewFeedbackViewModel.feedback}">
                <h3 class="heading-small" th:text="|Assessor ${iterStat.count}|">Assessor 1</h3>
                <div th:text="${item}" data-text-to-html="" class="wysiwyg-styles">Feedback text</div>
            </li>
        </ul>
    </div>

    <th:block th:insert="fragments/layout :: main-content-end" />
</main>

<th:block th:insert="fragments/layout :: footer" />
<th:block th:insert="fragments/layout :: body-end" />
<th:block th:insert="fragments/service-layout :: body-end" />
</body>
</html>
