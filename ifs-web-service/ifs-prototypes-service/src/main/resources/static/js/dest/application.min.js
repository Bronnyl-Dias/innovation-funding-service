if("undefined"==typeof IFS)var IFS={};IFS.application={},IFS.application.loadOrder={common:{init:function(){},finalize:function(){IFS.application.progressiveSelect.init()}},"app-form":{init:function(){IFS.core.unsavedChanges.init()}},"app-details":{init:function(){IFS.application.applicationPage.init()}},"app-invite":{init:function(){IFS.application.invites.init()}},"app-invite-display":{init:function(){IFS.application.inviteDisplay.init()}},"app-org-invite":{init:function(){IFS.application.repeatableOrgApplicantRows.init()}},"competition-management":{init:function(){IFS.application.competitionManagement.init()}}},IFS.application.progressiveSelect=function(){"use strict";var e,t=0;return{settings:{selectEl:"select.prog-menu",dropdownContainer:".assign-container .assign-button"},init:function(){e=this.settings,IFS.application.progressiveSelect.initDomChanges(),IFS.application.progressiveSelect.initEventHandlers()},initEventHandlers:function(){jQuery(document).on("click",function(){IFS.application.progressiveSelect.hideAll()}),jQuery("body").on("click",".assign-button [aria-controls]",function(e){e.stopPropagation(),IFS.application.progressiveSelect.toggleDropdown(this)})},initDomChanges:function(){jQuery(e.dropdownContainer).each(function(){IFS.application.progressiveSelect.initDropDownHTML(this)}),jQuery(e.selectEl).each(function(){IFS.application.progressiveSelect.selectToListHTML(this)})},selectToListHTML:function(e){e=jQuery(e),e.prev("label").remove(),e.next("button").remove();var t=e.children("option"),i=e.attr("name"),a='<ul class="bullet list-bullet">';t.each(function(){var e=jQuery(this),t=e.html(),n=e.attr("value");a+=e.is("[disabled]")?"<li>"+t+"</li>":'<li><button value="'+n+'" name="'+i+'" class="buttonlink">'+t+"</button></li>"}),a+="</ul>",e.after(a).remove(),jQuery("body").trigger("updateSerializedFormState")},initDropDownHTML:function(e){var i=jQuery(e),a="dropdown-"+t;i.next().wrapAll('<div id="'+a+'" aria-hidden="true">'),i.wrapInner('<button aria-expanded="false" aria-controls="'+a+'" type="button">'),t++},toggleDropdown:function(e){var t=jQuery(e),i=jQuery("#"+t.attr("aria-controls")),a="false"===t.attr("aria-expanded");IFS.application.progressiveSelect.hideAll(),a&&(t.attr("aria-expanded","true"),i.attr("aria-hidden","false"))},hideAll:function(){jQuery('[aria-controls*="dropdown-"][aria-expanded="true"]').attr("aria-expanded","false"),jQuery('[id^="dropdown-"][aria-hidden="false"]').attr("aria-hidden","true")}}}(),IFS.application.repeatableOrgApplicantRows=function(){"use strict";return{init:function(){jQuery("button[data-repeatable-rowcontainer]").attr("type","button"),jQuery("body").on("click","[data-repeatable-rowcontainer]",function(e){e.preventDefault(),IFS.application.repeatableOrgApplicantRows.addRow(this),IFS.application.repeatableOrgApplicantRows.showHideAddRowButton(!1)}),jQuery("body").on("click",".remove-another-row",function(e){e.preventDefault(),IFS.application.repeatableOrgApplicantRows.removeRow(this),IFS.application.repeatableOrgApplicantRows.showHideAddRowButton(!0)})},addRow:function(e){var t,i=jQuery(e).attr("data-repeatable-rowcontainer"),a=jQuery(i).children(".repeatable-row").length||0;t="update-org"===jQuery(e).data("applicant-table")?jQuery('<tr class="repeatable-row"><td class="form-group"><label for="stagedInvite.name"><span class="visually-hidden">Applicant name</span></label><input class="form-control width-full" type="text" id="stagedInvite.name" name="stagedInvite.name" value="" data-required-errormessage="Please enter a name." required="required" /></td><td class="form-group"><label for="stagedInvite.email"><span class="visually-hidden">Applicant email</span></label><input class="form-control width-full" type="email" id="stagedInvite.email" name="stagedInvite.email" value="" data-required-errormessage="Please enter an email address." required="required" /></td><td><button class="button" name="executeStagedInvite" value="true" type="submit">Invite</button></td><td class="alignright"><button class="remove-another-row buttonlink" name="removeInvite" type="button" value="0">Remove</button></td></tr>'):jQuery('<tr class="repeatable-row"><td class="form-group"><label for="applicants['+a+'].name"><span class="visually-hidden">Applicant name</span></label><input class="form-control width-full" type="text" id="applicants['+a+'].name" name="applicants['+a+'].name" value="" data-required-errormessage="Please enter a name." required="required" /></td><td class="form-group"><label for="applicants['+a+'].email"><span class="visually-hidden">Applicant email</span></label><input class="form-control width-full" type="email" id="applicants['+a+'].email" name="applicants['+a+'].email" value="" data-required-errormessage="Please enter an email address." required="required" /></td><td class="alignright"><button class="remove-another-row buttonlink" name="removeInvite" type="button" value="0">Remove</button></td></tr>'),jQuery(i).append(t),jQuery(t).find("input").first().focus()},removeRow:function(e){var t=jQuery(e),i=t.closest("tbody");i.find("input").each(function(){var e=jQuery(this).attr("id"),t=jQuery('.error-summary-list [href="#'+e+'"]');t.length&&t.parent().remove()});var a=jQuery(".error-summary-list li").length>0;a||jQuery(".error-summary").attr("aria-hidden","true"),t.closest("tr").remove();var n=jQuery(i).children(".repeatable-row");jQuery(n).each(function(e){var t=jQuery(this),i=t.find("label"),a=t.find("input");jQuery(i).each(function(){var t=jQuery(this),i=t.attr("for").replace(/\d+/g,e);t.attr("for",i)}),jQuery(a).each(function(){var t=jQuery(this),i=t.attr("id").replace(/\d+/g,e),a=t.attr("name").replace(/\d+/g,e);t.attr({id:i,name:a})})})},showHideAddRowButton:function(e){var t=jQuery('[name="addStagedInvite"]');t.attr("aria-hidden",!e)}}}(),IFS.application.applicationPage=function(){"use strict";return{init:function(){jQuery(document).on("click",'form.application-overview [name="assign_question"]',IFS.application.applicationPage.handleAssignQuestionFragmentReload)},handleAssignQuestionFragmentReload:function(e){var t,i=jQuery(this),a=i.closest("form.application-overview"),n=i.closest("li.section"),r=n.attr("id");if(n.closest('section[id^="section-"]').length&&(t=n.closest('section[id^="section-"]').attr("id").replace("section-","")),n.length&&t&&r)return jQuery.ajaxProtected({type:"POST",beforeSend:function(){"function"==typeof IFS.application.progressiveSelect.hideAll&&IFS.application.progressiveSelect.hideAll();var e=n.find(".assign-button");e.children("button").attr("aria-hidden","true"),n.find("img.section-status").attr("aria-hidden","true"),e.find(".reassign-status").remove(),e.append('<div class="reassign-status">Assigning to <strong>'+i.text()+"</strong>...</div>")},url:"?singleFragment=true&sectionId="+t,data:a.serialize()+"&"+i.attr("name")+"="+i.attr("value"),timeout:15e3,success:function(e){var t=jQuery("<div>"+e+"</div>"),i=t.find("#"+r);if(n.replaceWith(i),"function"==typeof IFS.application.progressiveSelect.initDropDownHTML){var a=i.find(".assign-button"),o=i.find("select.prog-menu");IFS.application.progressiveSelect.initDropDownHTML(a),IFS.application.progressiveSelect.selectToListHTML(o)}}}).fail(function(e){var t=IFS.core.autoSave.getErrorMessage(e);if(t){var i=n.find(".assign-button");i.children("button").attr("aria-hidden","false"),n.find("img.section-status").attr("aria-hidden","false"),n.find(".reassign-status").html('<div class="error-message">'+t+"</div>")}}),e.preventDefault(),!1}}}(),IFS.application.inviteDisplay=function(){"use strict";return{settings:{},init:function(){jQuery('[data-js-modal="modal-submit-remove-collaborator"]').click(function(){IFS.application.inviteDisplay.assignInviteIdOnClickRemove(this)})},assignInviteIdOnClickRemove:function(e){var t=jQuery(e).data("invite-id");jQuery('input[name="applicationInviteId"]').val(t)}}}();