<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
    <head>
        <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Funding'" />
    </head>

    <body th:with="context='assessment'" class="assessment assessment-finances-summary">
        <th:block th:insert="fragments/layout :: body-start" />
        <th:block th:insert="fragments/layout :: global-header" />

        <main tabindex="-1" id="content">
            <th:block th:insert="fragments/layout :: main-content-start" />
            <th:block th:insert="fragments/assessment :: assessment-header-sub (linkTitle='Back to your assessment overview',linkClass='link-back',linkUrl=@{/{id}(id=${model.assessmentId})})" />

            <th:block th:with="applicationName=${#strings.isEmpty(model.applicationName)} ? #{ifs.application.no_title} : ${model.applicationName}">
                <th:block th:insert="fragments/layout :: page-title" th:with="pageTitle='Funding',subTitle=${applicationName},size='heading-xlarge'" />
            </th:block>

            <h2 class="heading-medium">Finances overview</h2>
            <div class="form-group finances-summary">
                <div style="overflow: auto;">
                    <table>
                        <thead>
                            <tr>
                                <td />
                                <th scope="col" class="numeric">Total costs</th>
                                <th scope="col" class="numeric width-small">% Grant</th>
                                <th scope="col" class="numeric width-small-medium">Funding sought (&pound;)</th>
                                <th scope="col" class="numeric width-medium">Other public sector funding (&pound;)</th>
                                <th scope="col" class="numeric width-small-medium">Contribution to project (&pound;)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="applicationOrganisation : ${applicationOrganisations}">
                                <th scope="row">
                                    <div>
                                        <div th:text="${applicationOrganisation.name}" />
                                        <div th:if="${applicationOrganisation.id.equals(leadOrganisation.id)}">
                                            <small>Lead organisation</small>
                                        </div>
                                        <div th:unless="${applicationOrganisation.id.equals(leadOrganisation.id)}">
                                            <small>Partner</small>
                                        </div>
                                    </div>
                                </th>
                                <th:block th:with="organisationFinance=${organisationFinances.get(applicationOrganisation.id)}" th:if="${organisationFinances.containsKey(applicationOrganisation.id)}">
                                    <td class="numeric bold">
                                        &pound;<th:block th:text="${#numbers.formatInteger(organisationFinance.total, 0, 'DEFAULT')}" />
                                    </td>
                                    <td class="numeric" th:text="${organisationFinance.grantClaimPercentage}+'%'"/>
                                    <td class="numeric">
                                        <th:block th:text="${#numbers.formatInteger(organisationFinance.totalFundingSought, 0, 'DEFAULT')}" />
                                    </td>
                                    <td class="numeric">
                                        <th:block th:text="${#numbers.formatInteger(organisationFinance.totalOtherFunding, 0, 'DEFAULT')}" />
                                    </td>
                                    <td class="numeric">
                                        <th:block th:text="${#numbers.formatInteger(organisationFinance.totalContribution, 0, 'DEFAULT')}" />
                                    </td>
                                </th:block>
                            </tr>
                            <tr>
                                <th scope="row">Total</th>
                                <td class="numeric bold">
                                    &pound;<th:block th:text="${#numbers.formatInteger(financeTotal, 0, 'DEFAULT')}" />
                                </td>
                                <td></td>
                                <td class="numeric">
                                    <th:block th:text="${#numbers.formatInteger(totalFundingSought, 0, 'DEFAULT')}" />
                                </td>
                                <td class="numeric">
                                    <th:block th:text="${#numbers.formatInteger(totalOtherFunding, 0, 'DEFAULT')}" />
                                </td>
                                <td class="numeric">
                                    <th:block th:text="${#numbers.formatInteger(totalContribution, 0, 'DEFAULT')}" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <th:block th:include="finance/your-finances-sub-sections :: assessment_finances (${model})" />

            <th:block th:insert="fragments/layout :: main-content-end" />
        </main>

        <th:block th:insert="fragments/layout :: footer" />
        <th:block th:insert="fragments/layout :: body-end" />
    </body>
</html>
